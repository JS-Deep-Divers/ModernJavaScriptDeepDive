### 38

- 자바스크립트가 가장 많이 사용되는 분야 : 웹 브라우저 환경에서 동작하는 웹페이지/애플리케이션의 클라이언트 사이드
    - 브라우저에서 HTML, CSS와 함께 실행
    - 렌더링 : HTML,CSS,자바스크립트로 작성된 문서를 파싱하여 브라우저에 시각적으로 출력하는 것

[38.1] 요청과 응담

- 브라우저의 핵심 기능 : 필요한 리소스(HTML,CSS,자바스크립트,이미지,폰트 등의 정적파일 또는 서버가 동적으로 생성한 데이터)를 서버에 요청하고 서버로부터 응답 받아 브라우저에 시각적으로 렌더링하는 것

[38.2] HTTP 1.1과 HTTP 2.0

- HTTP : 웹에서 브라우저와 서버가 통신하기 위한 프로토콜(규약)

[38.3] HTML 파싱과 DOM 생성

- **DOM은 HTML문서를 파싱한 결과물**

[38.4] CSS 파싱과 CSSOM 생성

- 렌더링 엔진은 HTML을 처음부터 한 줄씩 순차적으로 파싱하여 DOM을 생성
- 렌더링 엔진은 DOM을 생성해 나가다가 CSS를 로드하는 link태그나 style태그를 만나면 DOM 생성을 일시 중단
- link 태그의 href어트리뷰트에 지정된 CSS파일을 서버에 요청하여 로드한 CSS 파일이나 style태그 내의 CSS를 HTML과 동일한 파싱 과정(바이트 → 문자 → 토큰 → 노드 → CSSOM)을 거치며 해석하여 CSSOM(CSS Object Model)을 생성
- CSS 파싱을 완료하면 HTML 파싱이 중단된 지점부터 다시 HTML을 파싱하기 시작하여 DOM 생성을 재개

[38.5] 렌터 트리 생성

- DOM과 CSSOM은 렌더링을 위해 렌더 트리로 결합
- 렌더 트리 → 브라우저 화면에 렌더링되는 노드만 구성
- 브라우저의 렌더링 과정이 다음 보기와 같이 반복해서 실행될 시 레이아웃 계산과 페인팅이 재차 실행된다. 이는 리렌더링 비용이 많이들고, 성능에 악영향을 주는 작업이다.

    |—보기—|

    - 자바스크립트에 의한 노드 추가 또는 삭제
    - 브라우저 창의 리사이징에 의한 뷰포트 크기 변경
    - HTML요소의 레이아웃에 변경을 발생시키는 width/height,margin,padding,border,display,position,to/right/bottom/left등의 스타일 변경

[38.6] 자바스크립트 파싱과 실행

- CSS 파싱 과정과 마찬가지로 렌더린 엔진은 HTML을 한 줄씩 순차적으로 파싱하여 DOM을 생성해 나가다가 자바스크립트 파일을 로드하는 script 태그나 자바스크립트 코드를 콘텐츠로 담은 script태그를 만나면 DOM생성을 일시 중단

[38.8] 자바스크립트 파싱에 의한 HTML 파싱 중단

- 렌더링 엔진과 자바스크립트 엔진은 병렬적으로 파싱을 실행하지 않고 직렬적으로 파싱을 수행

[38.9] script 태그의 async/defer 어트리뷰트

- 자바스크립트 파싱에 의한 DOM생성이 중단되는 문제를 근본적으로 해결하기 위해 HTML5부터 script 태그에 async와 defer 어트리뷰트가 추가
- src어트리뷰트를 통해 외부 자바스크립트 파일을 로드하는 경우에만 사용
    - async 어트리뷰트 :
        - HTML 파싱과 외부 자바스크립트 파일의 로드가 비동기적으로 동시에 진행
        - 자바스크립트의 파싱과 실행은 자바스크립트 파일의 로드가 완료된 직후 진행, 이때 HTML파싱이 중단
        - 여러 개의 script태그에 async 어트리뷰트를 지정하면 script태그의 순서와는 상관없이 로드가 완료된 자바스크립트부터 먼저 실행되므로 순서가 보장되지 않음
        - 따라서 순서 보장이 필요한 script태그에는 async 어트리뷰트를 지정하지 않아야 함
    - defer 어트리뷰트 :
        - HTML 파싱과 외부 자바스크립트 파일의 로드가 비동기적으로 동시에 진행
        - 단, 자바스크립트의 파싱과 실행은 HTML 파싱이 완료된 직후, DOM생성이 완료된 직후 진행
        - DOM생성이 완료된 이후 실행되어야 할 자바스크립트에 유용
